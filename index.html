<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>雲井鳴診断｜24問/60問・日本語ポップ版</title>
  <style>
    :root {
      --bg: linear-gradient(180deg,#f6f9ff,#ffffff);
      --fg: #0f172a;
      --muted: #475569;
      --brand: #8f82bc;   /* 紫 */
      --accent: #6ec5ff;  /* 水色 */
      --card: #ffffff;
      --border: #e2e8f0;
      --warn: #dc2626;
    }

    * { box-sizing: border-box }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--fg);
      background: var(--bg);
      line-height: 1.6;
    }
    .wrap { max-width: 920px; margin: 0 auto; padding: 16px 16px 96px }

    header {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      justify-content: space-between;
      margin: 12px 0 20px;
    }
    h1 {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(90deg, var(--brand), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 0 0 6px;
    }
    .muted { color: var(--muted); font-size: 13px }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      box-shadow: 0 6px 18px rgba(15,23,42,0.08);
      overflow: hidden;
    }
    .card.pad { padding: 20px }
    .title { font-size: 16px; font-weight: 700; margin: 0 0 6px }

    .progress { height: 10px; background: #e5e7eb; border-radius: 999px; overflow: hidden }
    .progress > div {
      height: 100%;
      background: linear-gradient(90deg, var(--brand), var(--accent));
      width: 0%;
      transition: width 0.3s ease;
    }

    .q { padding: 16px 18px; border-top: 1px solid var(--border) }
    .q:first-child { border-top: none }
    .qtitle { font-size: 15px; margin: 0 0 12px; line-height: 1.6 }
    .slider { display: flex; align-items: center; gap: 8px }
    input[type=range] {
      width: 100%;
      height: 36px; /* スマホでも操作しやすい */
      accent-color: var(--brand);
    }

    .btn {
      appearance: none;
      border: none;
      background: var(--brand);
      color: #fff;
      padding: 10px 16px;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .btn:hover { opacity: 0.9 }
    .btn.ghost {
      background: #fff;
      color: var(--brand);
      border: 1px solid var(--brand);
    }
    .btn.ghost:hover { background: #f1f5f9 }

    .footer {
      position: fixed;
      left: 0; right: 0; bottom: 0;
      background: rgba(255,255,255,0.98);
      border-top: 1px solid var(--border);
      backdrop-filter: saturate(180%) blur(10px);
    }
    .footer .inner {
      max-width: 920px;
      margin: 0 auto;
      padding: 10px 16px;
      display: flex;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .result {
      padding: 24px;
      border-radius: 18px;
      background: #fff;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      line-height: 1.7;
    }
    .result h2 {
      font-size: 24px;
      margin: 0 0 12px;
    }
    .result h3 {
      margin-top: 18px;
      font-size: 18px;
      border-left: 4px solid var(--brand);
      padding-left: 8px;
    }
    .badge {
      display: inline-block;
      background: #eef2ff;
      color: #3730a3;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 700;
      margin-right: 6px;
    }
    .result ul li::before {
      content: "✔ ";
      color: var(--brand);
      font-weight: bold;
    }

    ul { margin: 6px 0 10px 20px }
    .disclaimer { font-size: 12px; color: var(--muted) }
    .warn {
      color: var(--warn);
      background: #fee2e2;
      padding: 10px 14px;
      border-radius: 10px;
      margin-top: 10px;
      font-weight: 600;
    }

    #progressCard {
      position: sticky;
      top: 0;
      z-index: 50;
      background: var(--card);
      border-bottom: 1px solid var(--border);
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>雲井鳴診断（24問/60問・日本語ポップ版）</h1>
        <div class="muted">
          日常の質問に答えるだけで、あなたの立ち位置と相性がわかる診断です。回答はブラウザ内のみで処理されます。
        </div>
      </div>
      <div class="row">
        <button class="btn ghost" id="mode24">24問版（改良）</button>
        <button class="btn" id="mode60">60問版（じっくり）</button>
      </div>
    </header>


    <!-- ご案内 -->
    <section class="card pad" style="margin:12px 0; background:#f8fafc; border-left:5px solid var(--brand);">
      <div class="title">⚠️ ご案内</div>
      <div class="disclaimer" style="font-size:14px; line-height:1.6;">
        本診断はユング心理学系タイプ論およびソシオニクス理論に「着想を得て」雲井鳴が再設計したオリジナル診断です。<br>
        公式のソシオニクス/MBTI/16Personalities等とは関係がありません。<br>
        回答はブラウザ内で完結し、サーバ送信はされません。
      </div>
    </section>

    <!-- 進捗バー -->
    <section id="progressCard" class="card pad">
      <div class="progress"><div id="bar"></div></div>
      <div id="count" class="muted" style="margin-top:6px;">0/0 回答（0%）</div>
    </section>

    <!-- 質問リスト -->
    <section id="questionCard" class="card" style="margin-top:16px;"></section>

    <!-- 結果表示 -->
    <section id="resultCard" class="result" style="display:none; margin-top:20px;"></section>
    <div id="warnMsg" class="warn"></div>
  </div>

   <div class="footer">
    <div class="inner">
      <span id="modeLabel">24問版（改良）</span>
      <div>
        <button id="calcBtn" class="btn">診断する</button>
        <button id="copyBtn" class="btn ghost">結果をコピー</button>
      </div>
    </div>
  </div>


  <!-- ===================== JavaScript部分 ===================== -->
  <script>

/* ===================== 質問リスト ===================== */
/* ===================== 改良版 24問（各軸均等） ===================== */
const Q24 = [
  // E/I（外向―内向）
  {id:'q1', text:'予定のない休日、人と会う約束が入ると元気が出る。', axis:'EI', polarity:+1},
  {id:'q2', text:'初対面でも自分から話しかける方だ。', axis:'EI', polarity:+1},
  {id:'q3', text:'数時間の交流後は一人の時間で充電したくなる。', axis:'EI', polarity:-1},
  {id:'q4', text:'沈黙が続くと話題を出したくなる。', axis:'EI', polarity:+1},
  {id:'q5', text:'長時間の社交の後はどっと疲れる。', axis:'EI', polarity:-1},
  {id:'q6', text:'大人数よりも少人数の場が心地よい。', axis:'EI', polarity:-1},

  // N/S（直感―感覚）
  {id:'q7', text:'会話の中で「未来の展開」を想像することが多い。', axis:'NS', polarity:+1},
  {id:'q8', text:'新しいアイデアや可能性を考えるのが好きだ。', axis:'NS', polarity:+1},
  {id:'q9', text:'五感（音・匂い・触感）に敏感で気分が左右される。', axis:'NS', polarity:-1},
  {id:'q10', text:'具体的な数字や事実がないと安心できない。', axis:'NS', polarity:-1},
  {id:'q11', text:'道具やUIの手触りやデザインが気になる。', axis:'NS', polarity:-1},
  {id:'q12', text:'一見バラバラな出来事の中に共通点を探すのが得意だ。', axis:'NS', polarity:+1},

  // T/F（論理―感情）
  {id:'q13', text:'意見の対立ではまず根拠やルールを確認したい。', axis:'TF', polarity:+1},
  {id:'q14', text:'失敗を見たとき、原因分析を優先する。', axis:'TF', polarity:+1},
  {id:'q15', text:'会議では結論より当事者の気持ちを重視する。', axis:'TF', polarity:-1},
  {id:'q16', text:'人を傷つけそうな正論は言い方を工夫する。', axis:'TF', polarity:-1},
  {id:'q17', text:'チームの空気の変化に敏感だ。', axis:'TF', polarity:-1},
  {id:'q18', text:'論拠が弱い合意は長続きしないと感じる。', axis:'TF', polarity:+1},

  // J/P（計画性―柔軟性）
  {id:'q19', text:'週の初めに予定が埋まっていると安心する。', axis:'JP', polarity:+1},
  {id:'q20', text:'締切は前倒しで進めて余裕を作りたい。', axis:'JP', polarity:+1},
  {id:'q21', text:'旅先では行き当たりばったりが楽しい。', axis:'JP', polarity:-1},
  {id:'q22', text:'新しい情報があれば直前でも計画を変えられる。', axis:'JP', polarity:-1},
  {id:'q23', text:'机やフォルダは体系的に整理したい。', axis:'JP', polarity:+1},
  {id:'q24', text:'予定は空白を残して自由度を確保したい。', axis:'JP', polarity:-1},
];

/* ===================== 改良版 60問（各軸均等） ===================== */
const Q60 = [
  // E/I（外向―内向）15問
  {id:'q1', text:'予定が入るとむしろ元気になる。', axis:'EI', polarity:+1},
  {id:'q2', text:'大人数との雑談はエネルギーを与えてくれる。', axis:'EI', polarity:+1},
  {id:'q3', text:'初対面でも自分から話題を出すことが多い。', axis:'EI', polarity:+1},
  {id:'q4', text:'重要な決断はまず頭の中で整理してから話す。', axis:'EI', polarity:-1},
  {id:'q5', text:'長時間の社交後は一人の時間で回復する。', axis:'EI', polarity:-1},
  {id:'q6', text:'沈黙が続くと話題を出したくなる。', axis:'EI', polarity:+1},
  {id:'q7', text:'数時間の交流後はかなり疲れる。', axis:'EI', polarity:-1},
  {id:'q8', text:'仲間と過ごすことで活力が湧く。', axis:'EI', polarity:+1},
  {id:'q9', text:'人前で話すとき自然に盛り上げ役になる。', axis:'EI', polarity:+1},
  {id:'q10', text:'初対面より慣れた人と過ごす方が楽だ。', axis:'EI', polarity:-1},
  {id:'q11', text:'一人の時間がないとストレスが溜まる。', axis:'EI', polarity:-1},
  {id:'q12', text:'雑談の場にいると楽しくなる。', axis:'EI', polarity:+1},
  {id:'q13', text:'会話の後はどっと疲れることが多い。', axis:'EI', polarity:-1},
  {id:'q14', text:'大勢の輪の中に自然に入れる。', axis:'EI', polarity:+1},
  {id:'q15', text:'静かな環境の方が落ち着く。', axis:'EI', polarity:-1},

  // N/S（直感―感覚）15問
  {id:'q16', text:'会話で未来の展開を想像する。', axis:'NS', polarity:+1},
  {id:'q17', text:'旅行計画は体験テーマから考える。', axis:'NS', polarity:+1},
  {id:'q18', text:'新製品を見ると応用を考える。', axis:'NS', polarity:+1},
  {id:'q19', text:'五感の心地よさに敏感。', axis:'NS', polarity:-1},
  {id:'q20', text:'数字や具体例がないと不安。', axis:'NS', polarity:-1},
  {id:'q21', text:'バラバラな出来事に共通点を見出す。', axis:'NS', polarity:+1},
  {id:'q22', text:'道具やUIの触感や見た目を気にする。', axis:'NS', polarity:-1},
  {id:'q23', text:'環境の音や匂いで気分が変わる。', axis:'NS', polarity:-1},
  {id:'q24', text:'未来像や可能性を語るのが好きだ。', axis:'NS', polarity:+1},
  {id:'q25', text:'抽象より具体的な話が分かりやすい。', axis:'NS', polarity:-1},
  {id:'q26', text:'創造的な発想が次々に浮かぶ。', axis:'NS', polarity:+1},
  {id:'q27', text:'日常の小さな変化に敏感だ。', axis:'NS', polarity:-1},
  {id:'q28', text:'長期的な未来を考えることが多い。', axis:'NS', polarity:+1},
  {id:'q29', text:'デザインや質感が直感的に気になる。', axis:'NS', polarity:-1},
  {id:'q30', text:'偶然の出来事に意味を見出す。', axis:'NS', polarity:+1},

  // T/F（論理―感情）15問
  {id:'q31', text:'意見の対立では根拠を確認したい。', axis:'TF', polarity:+1},
  {id:'q32', text:'失敗を見たとき原因分析を優先する。', axis:'TF', polarity:+1},
  {id:'q33', text:'フィードバックは正確さを優先する。', axis:'TF', polarity:+1},
  {id:'q34', text:'結論よりも気持ちの納得を重視する。', axis:'TF', polarity:-1},
  {id:'q35', text:'正論も言い方を工夫して伝える。', axis:'TF', polarity:-1},
  {id:'q36', text:'チームの空気の変化に敏感だ。', axis:'TF', polarity:-1},
  {id:'q37', text:'論理の穴に気づくと気になる。', axis:'TF', polarity:+1},
  {id:'q38', text:'相手の気持ちを最優先する。', axis:'TF', polarity:-1},
  {id:'q39', text:'論拠が弱い合意は納得できない。', axis:'TF', polarity:+1},
  {id:'q40', text:'共感よりも正確さを優先する。', axis:'TF', polarity:+1},
  {id:'q41', text:'雰囲気が悪いと気になって集中できない。', axis:'TF', polarity:-1},
  {id:'q42', text:'ルールを守らないとモヤモヤする。', axis:'TF', polarity:+1},
  {id:'q43', text:'人間関係の調和を崩したくない。', axis:'TF', polarity:-1},
  {id:'q44', text:'筋の通らない話は納得できない。', axis:'TF', polarity:+1},
  {id:'q45', text:'相手の立場を考えて発言を変える。', axis:'TF', polarity:-1},

  // J/P（計画性―柔軟性）15問
  {id:'q46', text:'予定が埋まっていると安心する。', axis:'JP', polarity:+1},
  {id:'q47', text:'締切は前倒しで進めたい。', axis:'JP', polarity:+1},
  {id:'q48', text:'旅先では気分で動くのが好き。', axis:'JP', polarity:-1},
  {id:'q49', text:'直前でも計画を変えられる。', axis:'JP', polarity:-1},
  {id:'q50', text:'机やフォルダを整理整頓したい。', axis:'JP', polarity:+1},
  {id:'q51', text:'予定は空白を残したい。', axis:'JP', polarity:-1},
  {id:'q52', text:'ToDoを期限で整理する。', axis:'JP', polarity:+1},
  {id:'q53', text:'新しい情報があればすぐ変更する。', axis:'JP', polarity:-1},
  {id:'q54', text:'ルーティンが整っていると安心する。', axis:'JP', polarity:+1},
  {id:'q55', text:'計画よりも直感を優先する。', axis:'JP', polarity:-1},
  {id:'q56', text:'複数案件を同時進行できる仕組みが好き。', axis:'JP', polarity:+1},
  {id:'q57', text:'予定に縛られるのは苦手だ。', axis:'JP', polarity:-1},
  {id:'q58', text:'計画を立てて動くと安心する。', axis:'JP', polarity:+1},
  {id:'q59', text:'行き当たりばったりを楽しめる。', axis:'JP', polarity:-1},
  {id:'q60', text:'秩序や安定を優先したい。', axis:'JP', polarity:+1},
];

/* ===================== タイプ定義 ===================== */
const TYPES = {
  IEE:{name:'アイデア冒険家', cluster:'アイデアマン型', perspective:'アイデア視点', quadra:'Delta'},
  IEI:{name:'夢見る共感者', cluster:'夢語り型', perspective:'ドラマティック視点', quadra:'Beta'},
  EIE:{name:'ドラマティック演出家', cluster:'盛り上げ役型', perspective:'ドラマティック視点', quadra:'Beta'},
  EII:{name:'お人好し仲裁役', cluster:'癒し型', perspective:'調和視点', quadra:'Delta'},
  ILE:{name:'ひらめき発明家', cluster:'アイデアマン型', perspective:'アイデア視点', quadra:'Alpha'},
  LII:{name:'理屈マスター', cluster:'参謀型', perspective:'ルール視点', quadra:'Alpha'},
  LIE:{name:'戦略プランナー', cluster:'参謀型', perspective:'アイデア視点', quadra:'Gamma'},
  ILI:{name:'未来予報士', cluster:'夢語り型', perspective:'ルール視点', quadra:'Gamma'},
  ESE:{name:'場を盛り上げ隊長', cluster:'ムードメーカー型', perspective:'主役視点', quadra:'Alpha'},
  ESI:{name:'正義の番人', cluster:'守り役型', perspective:'ルール視点', quadra:'Gamma'},
  SEE:{name:'カリスマ配信者', cluster:'ムードメーカー型', perspective:'主役視点', quadra:'Gamma'},
  SLE:{name:'ゴーゴー行動派', cluster:'盛り上げ役型', perspective:'主役視点', quadra:'Beta'},
  SEI:{name:'ゆるふわ癒し役', cluster:'癒し型', perspective:'調和視点', quadra:'Alpha'},
  LSE:{name:'段取りマネージャー', cluster:'段取り型', perspective:'ルール視点', quadra:'Delta'},
  LSI:{name:'ルール番長', cluster:'段取り型', perspective:'ルール視点', quadra:'Beta'},
  SLI:{name:'マイペース職人', cluster:'守り役型', perspective:'調和視点', quadra:'Delta'},
};

/* ===================== 相性（デュアル/同クアドラ/コンフリクト） ===================== */
const REL = {
  IEE:{dual:'マイペース職人', same:['段取りマネージャー','お人好し仲裁役'], conflict:'ルール番長'},
  IEI:{dual:'ゴーゴー行動派', same:['ドラマティック演出家','ルール番長'], conflict:'段取りマネージャー'},
  EIE:{dual:'ルール番長', same:['夢見る共感者','ゴーゴー行動派'], conflict:'マイペース職人'},
  EII:{dual:'カリスマ配信者', same:['段取りマネージャー','マイペース職人'], conflict:'ゴーゴー行動派'},
  ILE:{dual:'ゆるふわ癒し役', same:['理屈マスター','場を盛り上げ隊長'], conflict:'正義の番人'},
  LII:{dual:'場を盛り上げ隊長', same:['ひらめき発明家','ゆるふわ癒し役'], conflict:'カリスマ配信者'},
  LIE:{dual:'正義の番人', same:['未来予報士','理屈マスター'], conflict:'ゆるふわ癒し役'},
  ILI:{dual:'カリスマ配信者', same:['正義の番人','戦略プランナー'], conflict:'場を盛り上げ隊長'},
  ESE:{dual:'理屈マスター', same:['ひらめき発明家','ゆるふわ癒し役'], conflict:'未来予報士'},
  ESI:{dual:'戦略プランナー', same:['未来予報士','理屈マスター'], conflict:'ひらめき発明家'},
  SEE:{dual:'未来予報士', same:['正義の番人','戦略プランナー'], conflict:'理屈マスター'},
  SLE:{dual:'夢見る共感者', same:['ドラマティック演出家','ルール番長'], conflict:'お人好し仲裁役'},
  SEI:{dual:'ひらめき発明家', same:['場を盛り上げ隊長','理屈マスター'], conflict:'戦略プランナー'},
  LSE:{dual:'夢見る共感者', same:['お人好し仲裁役','マイペース職人'], conflict:'ドラマティック演出家'},
  LSI:{dual:'ドラマティック演出家', same:['夢見る共感者','ゴーゴー行動派'], conflict:'アイデア冒険家'},
  SLI:{dual:'アイデア冒険家', same:['段取りマネージャー','お人好し仲裁役'], conflict:'ドラマティック演出家'},
};

/* ===================== 詳細（強み・弱み・VTuber適性・立ち位置） ===================== */
/* ===================== タイプ詳細（全16タイプ＋variants） ===================== */
const DETAIL = {
  IEI: {
    intro: "未来を物語として語り、人の感情を優しくすくい上げる感受性の持ち主。雰囲気を大切にし、場に安心感をもたらします。",
    strength: ["感情に敏感で共感力が高い","芸術的センス","未来像を語れる","雰囲気を和ませる","安心感を与える"],
    explainStrength: "あなたがいることで、周囲は安心し、自分の物語を語りやすくなります。芸術的なセンスと直感が合わさり、人々に共感を与えることができます。",
    weak: ["現実タスクが苦手","優柔不断","プレッシャーに弱い","対立回避で先送り","主導者に萎縮"],
    explainWeak: "現実的な進行やタスク処理が苦手で、優柔不断になりやすい面も。感情を大切にするがゆえにプレッシャーや対立に弱い傾向があります。",
    vtuber: ["ASMR","朗読・歌枠","世界観重視の雑談"],
    role: "ストーリーテラー／雰囲気担当",
    explainRelation: "ゴーゴー行動派（SLE）と組むと、感受性と行動力が補完し合い、物語を現実化できる強力なペアになります。",
    explainRole: "雰囲気担当として、場をやわらかくし、ストーリー性を加えて企画を彩ります。",
    variants: {
      dreamer: "幻想的な発想が際立つ『ドリーマー型』。空想を語り周囲を魅了します。",
      empath: "人の心に寄り添う『共感者型』。感情に敏感で支えになります。",
      artist: "芸術的表現に長けた『アーティスト型』。独自の世界を描き出します。"
    }
  },
  IEE: {
    intro: "人やアイデアを縦横無尽につなぐ冒険者。次々に新しい企画を生み出し、コミュニティに風を吹き込む存在です。",
    strength: ["出会いから発想を得る","流行に敏感","社交的で柔軟","巻き込み力が高い","ネットワーク作りが得意"],
    explainStrength: "あなたは人や情報から刺激を受け、企画を次々と発想します。場を盛り上げ、関係を広げる力が大きな強みです。",
    weak: ["管理が苦手","集中が続かない","実行力不足","興味が移りやすい","情熱が拡散しやすい"],
    explainWeak: "好奇心が旺盛すぎるあまり、継続や管理が苦手。熱意が拡散してまとまりを欠くことがあります。",
    vtuber: ["参加型配信","突発コラボ","ゲストトーク"],
    role: "アイデアマン／種まき役",
    explainRelation: "マイペース職人（SLI）と組むと、地道な努力でアイデアが現実化します。LSEやEIIのような安定志向タイプとも良好な関係が築けます。",
    explainRole: "常に新しい火種をまく役割。場を刺激し続ける仕掛け人です。",
    variants: {
      connector: "人脈を広げる『コネクター型』。交流から新企画を引き出します。",
      explorer: "新しい刺激を求める『冒険家型』。未知に挑む姿勢が魅力。",
      catalyst: "場を変えるきっかけを作る『触媒型』。人の情熱を引き出します。"
    }
  },
  EIE: {
    intro: "情熱を舞台に変える演出家。感情を操り、物語を演出するカリスマ性を持ちます。",
    strength: ["ストーリーテリング","感情表現で人を動かす","カリスマ性","共感を引き出す","鼓舞力"],
    explainStrength: "人の心を掴み、物語として場を演出する力があります。あなたが語れば人々は引き込まれ、共感と熱狂が生まれます。",
    weak: ["感情的で疲れやすい","論理に弱い","ドラマを盛りすぎる","管理が苦手","冷静さ不足"],
    explainWeak: "熱量が高すぎるあまり、冷静さを欠いたり大げさに見られることがあります。計画や管理が苦手で、感情に流されやすい傾向も。",
    vtuber: ["歌枠","演出企画","物語実況"],
    role: "演出担当／ムードシェイパー",
    explainRelation: "ルール番長（LSI）が、あなたの情熱を現実的な秩序で支えます。同じベータクアドラのIEI・SLEとも共鳴します。",
    explainRole: "場の熱量を高め、物語性を与える演出者。感情を軸に場を操ります。",
    variants: {
      orator: "説得力に富む『オレーター型』。演説や語りで人を動かします。",
      director: "物語を仕立てる『ディレクター型』。場をドラマティックに演出。",
      motivator: "人を奮い立たせる『モチベーター型』。熱気を生む存在です。"
    }
  },
  EII: {
    intro: "誠実で温厚な仲裁役。人の気持ちを尊重し、調和を保つ橋渡し役です。",
    strength: ["誠実さと信頼感","仲裁力","共感力","長期関係を重視","道徳心"],
    explainStrength: "人の気持ちに寄り添い、誠実さで信頼を集めます。場の空気を和らげ、持続的な人間関係を築けます。",
    weak: ["意思表示が弱い","主導できない","遠慮がち","感情に流されやすい","融通が利かない"],
    explainWeak: "強く出られず、遠慮しすぎて自分を犠牲にすることも。感情に影響されやすく、柔軟性に欠ける面があります。",
    vtuber: ["お悩み相談","共感雑談","仲裁コラボ"],
    role: "仲裁役／裏方サポート",
    explainRelation: "カリスマ配信者（SEE）の勢いを受け止めるのに最適な相手。LSEやSLIのような安定志向タイプとも相性良し。",
    explainRole: "人と人の間に入り、関係を調整して和やかな雰囲気を作ります。",
    variants: {
      counselor: "相談役として頼られる『カウンセラー型』。心の支えとなる。",
      mediator: "対立を和らげる『メディエーター型』。場を調整する力がある。",
      guardian: "信頼を守り抜く『ガーディアン型』。人を裏切らない誠実さ。"
    }
  },
  ILE: {
    intro: "自由奔放で好奇心旺盛な発明家。新しい可能性を見つけ出し、場に驚きを生みます。",
    strength: ["発想力豊か","柔軟性の高さ","論理と直感の融合","幅広い興味","仕掛け人"],
    explainStrength: "既存の枠を壊し、新しい企画を次々に思いつきます。驚きや面白さを仕掛けるのが得意です。",
    weak: ["飽きやすい","実行力不足","深掘り前に次へ飛びつく","リスク管理が甘い","収拾がつかなくなる"],
    explainWeak: "アイデアに夢中になりすぎて実行が追いつかないことも。場を混乱させるリスクがあります。",
    vtuber: ["新作実況","実験企画","ネタ枠配信"],
    role: "ネタ出し／発明家",
    explainRelation: "ゆるふわ癒し役（SEI）が落ち着きを与え、あなたの発想を形にします。LIIやESEとも補完関係にあります。",
    explainRole: "場に突発的な驚きや刺激を投入し、停滞を打ち破る存在。",
    variants: {
      trickster: "突拍子もないアイデアを出す『トリックスター型』。驚きを与える。",
      tinkerer: "実験を楽しむ『ティンカー型』。失敗すらネタにする。",
      innovator: "新しい発想を仕掛ける『イノベーター型』。未来志向。"
    }
  },
  LII: {
    intro: "冷静沈着な理屈の参謀。複雑な事象を分析・整理し、体系化する頭脳型タイプです。",
    strength: ["分析力","理論体系化","客観性","批判的思考","精度の高い計画"],
    explainStrength: "複雑な情報を整理し、理論として理解可能にする力を持ちます。冷静な分析で信頼されます。",
    weak: ["感情に鈍感","頑固","細部に固執","空気を読みにくい","人間関係軽視"],
    explainWeak: "感情や雰囲気の理解が苦手。頑固で柔軟性に欠けるため、周囲から冷たい印象を持たれることがあります。",
    vtuber: ["解説配信","考察動画","検証企画"],
    role: "冷静参謀／まとめ役",
    explainRelation: "場を盛り上げ隊長（ESE）の感情表現を論理で支えます。ILEやSEIとも安定した関係を築けます。",
    explainRole: "ブレーンとして理論の基盤を提供し、方向性を安定させます。",
    variants: {
      analyst: "徹底的に分解する『アナリスト型』。論理を追求。",
      architect: "全体構造を設計する『アーキテクト型』。体系立てが得意。",
      judge: "公平さを大切にする『ジャッジ型』。正義感のある参謀。"
    }
  },
  LIE: {
    intro: "未来を見据え、成果を出すことに全力を注ぐ戦略家。実行力と大局観を併せ持つプロデューサータイプ。",
    strength: ["戦略性","大局観","実行力","成果志向","ビジネス感覚"],
    explainStrength: "夢を実現するための現実的な道筋を描き、実際に推進していける強力なリーダーです。",
    weak: ["冷徹に見られる","感情配慮が弱い","柔軟性不足","速度感がズレる","短期関係を軽視"],
    explainWeak: "結果を追求するあまり、人間関係や感情に疎く冷たく見られることがあります。",
    vtuber: ["企画立案","長期的プロジェクト配信"],
    role: "戦略参謀／プロデューサー",
    explainRelation: "正義の番人（ESI）が守りを担い、あなたの攻めを支えます。ILIやLIIとも安定した連携が可能。",
    explainRole: "場に方向性と推進力を与え、プロジェクトを成功に導く存在。",
    variants: {
      strategist: "未来を見据える『ストラテジスト型』。冷静で成果志向。",
      producer: "進行を管理する『プロデューサー型』。効率を重視。",
      commander: "指揮を執る『コマンダー型』。突破力で導く。"
    }
  },
  ILI: {
    intro: "未来を予測し、慎重に動く観察者。冷静な洞察力でリスクを管理する賢者です。",
    strength: ["未来予測","リスク管理","冷静な論理性","観察眼","長期視点"],
    explainStrength: "場を俯瞰し、未来の展開を見抜く力を持ちます。リスクを回避し、安全な進行を支えます。",
    weak: ["行動が遅い","悲観的","柔軟性不足","即応性に欠ける","流れに乗れない"],
    explainWeak: "慎重さが過ぎて行動が遅れることがあります。チャンスを逃しやすい傾向があります。",
    vtuber: ["考察配信","解説動画","シナリオ分析"],
    role: "冷静参謀／未来予報",
    explainRelation: "カリスマ配信者（SEE）が勢いを与え、あなたの慎重さと補完関係にあります。ESIやLIEとも同じ価値観を共有できます。",
    explainRole: "プロジェクトに安定を与え、長期的な展望を提示する役割。",
    variants: {
      prophet: "未来を読み解く『予言者型』。先を見通す目を持つ。",
      observer: "静かに観察する『オブザーバー型』。冷静沈着。",
      critic: "リスクを見抜く『クリティック型』。慎重で批判的。"
    }
  },
  ESE: {
    intro: "明るさと社交性で場を支配するエンターテイナー。人を楽しませ、雰囲気を高める天性のムードメーカーです。",
    strength: ["明るさで和ませる","初対面に強い","場を盛り上げる","感情キャッチ","サービス精神旺盛"],
    explainStrength: "人との距離を一瞬で縮め、明るい雰囲気をつくるのが得意です。場にいるだけで周囲を元気にします。",
    weak: ["論理が苦手","感情に振り回されやすい","瞬間重視","主導しすぎる","疲れやすい"],
    explainWeak: "感情に敏感すぎて疲れやすい面も。論理的な批判に弱い傾向があります。",
    vtuber: ["雑談","歌枠","イベントMC"],
    role: "司会進行／場の中心",
    explainRelation: "理屈マスター（LII）が、あなたの感情を論理で支えてくれます。ILEやSEIとも好相性です。",
    explainRole: "盛り上げ役として、場を明るくし、全員が安心して楽しめる空気をつくります。",
    variants: {
      entertainer: "人を楽しませる『エンターテイナー型』。場を盛り上げる。",
      host: "気配り上手な『ホスト型』。全員に目を配る。",
      spark: "雰囲気を一変させる『スパーク型』。空気を活性化。"
    }
  },
  SEE: {
    intro: "豪快で華やかなカリスマ。自信に満ちたパフォーマンスで人を魅了する、表舞台の王者。",
    strength: ["カリスマ性","瞬発力","豪快さ","巻き込み力","自信あるパフォーマンス"],
    explainStrength: "あなたは自然と注目を集め、人を巻き込みます。舞台の中心に立つことで最も輝ける存在です。",
    weak: ["持続力不足","調整が苦手","衝突を恐れない","ルール嫌い","反発しやすい"],
    explainWeak: "勢いが強すぎるあまり、摩擦を生みやすい面があります。継続や地道さに欠けがちです。",
    vtuber: ["アイドル活動","歌ってみた","ファンイベント"],
    role: "メインスター／ムード支配者",
    explainRelation: "お人好し仲裁役（EII）があなたの豪快さを受け止めます。ILIやESIとも同じ価値観を共有できます。",
    explainRole: "華やかさと勢いで場を支配する中心人物。",
    variants: {
      idol: "注目を浴びる『アイドル型』。華やかさで人を魅了。",
      leader: "前に出て牽引する『リーダー型』。強烈な存在感。",
      challenger: "挑戦を恐れない『チャレンジャー型』。勝負強い。"
    }
  },
  SLE: {
    intro: "勢いと突破力で状況を切り拓くアクションリーダー。挑戦を恐れず、現場で勝負する戦士タイプです。",
    strength: ["即断即決","勇敢さ","突破力","リーダーシップ","勢い"],
    explainStrength: "決断が早く、困難を恐れず挑戦できます。あなたが先頭に立つことで場に流れが生まれます。",
    weak: ["計画不足","衝突を招きやすい","リスク管理が甘い","感情配慮に欠ける","協調性が低い"],
    explainWeak: "勢い任せで無計画に動いてしまうことも。対立を避けにくく摩擦を生みやすいです。",
    vtuber: ["挑戦企画","対戦ゲーム","体当たり系配信"],
    role: "切り込み隊長／アクション担当",
    explainRelation: "夢見る共感者（IEI）が物語性を補い、あなたの行動に深みを与えます。EIEやLSIとも強力な連携が可能です。",
    explainRole: "突破役として場を動かし、新しい展開を切り開く存在。",
    variants: {
      warrior: "戦いに挑む『ウォリアー型』。困難に立ち向かう。",
      pioneer: "新しい道を切り開く『パイオニア型』。挑戦心が強い。",
      enforcer: "統率して押し進める『エンフォーサー型』。力強さが特徴。"
    }
  },
  SEI: {
    intro: "柔らかく穏やかな癒し手。人を安心させる雰囲気を持ち、居心地の良さを提供する存在です。",
    strength: ["雰囲気を和ませる","聞き上手","安心感を与える","快適さを大切にする","柔らかい接し方"],
    explainStrength: "場を柔らかくし、人を安心させます。快適さや居心地の良さに敏感で、それを共有できます。",
    weak: ["受け身","決断力不足","主導性が弱い","長期展望に弱い","流されやすい"],
    explainWeak: "受け身で流されやすく、決断力に欠けることがあります。主体性が弱いと感じられることも。",
    vtuber: ["ASMR","雑談","癒し枠"],
    role: "雰囲気担当／聞き役",
    explainRelation: "ひらめき発明家（ILE）の自由さを受け止めます。ESEやLIIとも好相性です。",
    explainRole: "聞き役として人の心を和らげ、安心できる雰囲気を提供します。",
    variants: {
      healer: "人を癒す『ヒーラー型』。安心感を与える。",
      companion: "寄り添う『コンパニオン型』。支え合う関係を築く。",
      comforter: "快適さを重視する『コンフォーター型』。居心地を大切にする。"
    }
  },
  LSE: {
    intro: "現実的で計画的な段取り上手。プロジェクトを滞りなく進めることに優れる。",
    strength: ["計画遂行力","リソース管理","責任感","安定進行","信頼感"],
    explainStrength: "あなたはチームに基盤を与え、安定的に成果を出すことができます。効率を重んじ、信頼を築ける存在です。",
    weak: ["柔軟性不足","理想に弱い","型にはまりやすい","融通が利かない","遊び心不足"],
    explainWeak: "規律を重んじるあまり、柔軟さに欠けたり遊び心を忘れがちです。新奇な挑戦に不安を感じやすい傾向があります。",
    vtuber: ["定期配信","進行・運営企画","整理術コンテンツ"],
    role: "進行管理／裏方リーダー",
    explainRelation: "夢見る共感者（IEI）が情緒を与え、あなたの実務力を彩ります。EIIやSLIとも良好な連携を築けます。",
    explainRole: "安定を提供し、進行管理で場を支える裏方リーダー。",
    variants: {
      manager: "進行を守る『マネージャー型』。堅実で信頼される。",
      organizer: "整理整頓に長けた『オーガナイザー型』。効率的。",
      steward: "責任を重んじる『スチュワード型』。安定志向。"
    }
  },
  LSI: {
    intro: "規律と正確さを重んじる監督役。秩序を守り、集団を安定させる柱のような存在。",
    strength: ["正確性と几帳面さ","秩序維持","統率力","責任感","安定感"],
    explainStrength: "あなたは規律を大切にし、場を安定させます。秩序の番人として信頼を集めます。",
    weak: ["柔軟性不足","新奇性に弱い","厳格すぎる","感情に疎い","批判的になりやすい"],
    explainWeak: "厳格すぎて周囲に恐れられたり、新しい挑戦に消極的になることがあります。",
    vtuber: ["大会運営","検証枠","ルール解説配信"],
    role: "審判役／秩序の要",
    explainRelation: "ドラマティック演出家（EIE）の熱量を冷静に管理できます。IEIやSLEとも同じベータクアドラで協力的。",
    explainRole: "公正さと秩序を担保し、集団に安定を与える存在。",
    variants: {
      strict: "秩序を徹底する『ストリクト型』。規律を守り抜く。",
      supportive: "仲間を支える『サポーター型』。公平さを大切にする。",
      tactical: "状況を読む『タクティカル型』。規律を戦術的に活用。"
    }
  },
  SLI: {
    intro: "忍耐強くコツコツ積み上げる職人気質。安定した努力で成果を出す縁の下の力持ち。",
    strength: ["継続力","職人気質","落ち着き","安定感","実務力"],
    explainStrength: "あなたは堅実に作業をこなし、着実に成果を積み上げます。地道さと安定感で信頼されます。",
    weak: ["消極的","社交性が低い","頑固","新しい挑戦に消極的","人間関係に疎い"],
    explainWeak: "内向的で消極的な面があり、新しい変化や人間関係の構築に苦手意識を持ちやすいです。",
    vtuber: ["ものづくり配信","作業ASMR","検証レビュー"],
    role: "職人枠／安定要員",
    explainRelation: "アイデア冒険家（IEE）の自由な発想を、あなたの安定感で実現に導きます。EIIやLSEとも補完関係にあります。",
    explainRole: "地道な努力で基盤を支える職人。縁の下の力持ち的存在。",
    variants: {
      craftsman: "実務力に優れた『クラフツマン型』。地道な努力家。",
      stabilizer: "安定を重んじる『スタビライザー型』。穏やかで落ち着きがある。",
      minimalist: "必要最小限で満足する『ミニマリスト型』。無駄を嫌う。"
    }
  },
  ESI: {
    intro: "誠実さと倫理観で仲間を守る守護者。揺るぎない価値観を持ち、安心できる土台を築きます。",
    strength: ["誠実さと一貫性","倫理観の高さ","守護意識","忠誠心","関係管理能力"],
    explainStrength: "あなたは正義感を持って行動し、人間関係を大切に守ります。信頼を築ける存在です。",
    weak: ["批判的になりやすい","柔軟性不足","保守的","主観的判断が強い","挑戦に消極的"],
    explainWeak: "価値観を重視するあまり、柔軟性を欠いたり批判的になりがちです。新しい挑戦に慎重です。",
    vtuber: ["ルール系配信","真面目対談","監督役"],
    role: "守護者／秩序の番人",
    explainRelation: "戦略プランナー（LIE）が攻めを担い、あなたが守りを支えることで理想的な補完関係を築けます。",
    explainRole: "守りの役割として場を安定させ、信頼の基盤を築く存在。",
    variants: {
      guardian: "仲間を守る『ガーディアン型』。忠誠心が強い。",
      critic: "批判的に状況を判断する『クリティック型』。妥協を許さない。",
      loyalist: "信頼を重んじる『ロイヤリスト型』。裏切りを嫌う。"
    }
  }
};

/* ===================== 結果描画 ===================== */
function renderResultView(){
  if(!lastResult) return;
  const {t, rel, d, ax} = lastResult;
  const html = [];

  // タイプ基本情報（オリジナル名＋ソシオニクス表記）
  html.push(`
    <div class="badge">${t.cluster}</div> 
    <div class="badge">${t.perspective}</div> 
    <div class="badge">クアドラ：${t.quadra}</div>
  `);
  html.push(`<h2>あなたは <b>「${t.name}」</b> タイプ</h2>`);
  html.push(`<p class="muted">（ソシオニクス表記：<b>${lastResult.tKey}</b>）</p>`);
  html.push(`<p>${d.intro}</p>`);

  // ▼ 補足ラベル（variants）
  let variantKey = null;
  switch (lastResult.tKey) {
    case "IEI":
      if (ax.NS > 4) variantKey = "dreamer";
      else if (ax.TF < -2) variantKey = "empath";
      else variantKey = "artist";
      break;
    case "IEE":
      if (ax.EI > 4) variantKey = "connector";
      else if (ax.NS > 3) variantKey = "explorer";
      else variantKey = "catalyst";
      break;
    case "EIE":
      if (ax.TF < -3) variantKey = "orator";
      else if (ax.NS > 2) variantKey = "director";
      else variantKey = "motivator";
      break;
    case "EII":
      if (ax.TF < -3) variantKey = "counselor";
      else if (ax.EI < -2) variantKey = "mediator";
      else variantKey = "guardian";
      break;
    case "ILE":
      if (ax.NS > 5) variantKey = "trickster";
      else if (ax.TF > 3) variantKey = "tinkerer";
      else variantKey = "innovator";
      break;
    case "LII":
      if (ax.TF > 4) variantKey = "analyst";
      else if (ax.NS > 3) variantKey = "architect";
      else variantKey = "judge";
      break;
    case "LIE":
      if (ax.JP > 4) variantKey = "strategist";
      else if (ax.TF > 2) variantKey = "producer";
      else variantKey = "commander";
      break;
    case "ILI":
      if (ax.NS > 4) variantKey = "prophet";
      else if (ax.EI < -3) variantKey = "observer";
      else variantKey = "critic";
      break;
    case "ESE":
      if (ax.EI > 4) variantKey = "entertainer";
      else if (ax.TF < -2) variantKey = "host";
      else variantKey = "spark";
      break;
    case "SEE":
      if (ax.EI > 4) variantKey = "idol";
      else if (ax.JP > 3) variantKey = "leader";
      else variantKey = "challenger";
      break;
    case "SLE":
      if (ax.EI > 4) variantKey = "warrior";
      else if (ax.NS > 2) variantKey = "pioneer";
      else variantKey = "enforcer";
      break;
    case "SEI":
      if (ax.EI < -4) variantKey = "healer";
      else if (ax.TF < -2) variantKey = "companion";
      else variantKey = "comforter";
      break;
    case "LSE":
      if (ax.JP > 4) variantKey = "manager";
      else if (ax.NS < -2) variantKey = "organizer";
      else variantKey = "steward";
      break;
    case "LSI":
      if (ax.JP > 5) variantKey = "strict";
      else if (ax.TF < -3) variantKey = "supportive";
      else variantKey = "tactical";
      break;
    case "SLI":
      if (ax.JP > 4) variantKey = "craftsman";
      else if (ax.EI < -3) variantKey = "stabilizer";
      else variantKey = "minimalist";
      break;
    case "ESI":
      if (ax.TF < -4) variantKey = "guardian";
      else if (ax.JP > 3) variantKey = "critic";
      else variantKey = "loyalist";
      break;
  }
  if (variantKey && d.variants && d.variants[variantKey]) {
    html.push(`<p class="muted">補足：${d.variants[variantKey]}</p>`);
  }

  // 強み
  html.push(`<h3>🌟 強み</h3>`);
  html.push(`<ul>${d.strength.map(x=>`<li>${x}</li>`).join('')}</ul>`);
  if (d.explainStrength) html.push(`<p>${d.explainStrength}</p>`);

  // 弱み
  html.push(`<h3>⚠️ 弱み</h3>`);
  html.push(`<ul>${d.weak.map(x=>`<li>${x}</li>`).join('')}</ul>`);
  if (d.explainWeak) html.push(`<p>${d.explainWeak}</p>`);

  // 相性
  html.push(`<h3>🤝 相性</h3>`);
  if (d.explainRelation) {
    html.push(`<p>${d.explainRelation}</p>`);
  } else {
    html.push(`<ul>
      <li><b>合う（デュアル）：</b>${rel?.dual||'—'}</li>
      <li><b>良い（同クアドラ）：</b>${(rel?.same||[]).join('・')||'—'}</li>
      <li><b>注意（コンフリクト）：</b>${rel?.conflict||'—'}</li>
    </ul>`);
  }

  // VTuber適性
  html.push(`<h3>🎤 VTuber適性</h3>`);
  html.push(`<ul>${d.vtuber.map(x=>`<li>${x}</li>`).join('')}</ul>`);

  // コラボ立ち位置
  html.push(`<h3>🎭 コラボの立ち位置</h3>`);
  html.push(`<p>${d.role}</p>`);
  if (d.explainRole) html.push(`<p>${d.explainRole}</p>`);

  // 軸スコア（数値＋日本語補足）
  function explainAxis(label, value){
    if(value > 3) return `${label}：+${value.toFixed(1)}（かなり${label}寄り）`;
    if(value > 1) return `${label}：+${value.toFixed(1)}（やや${label}寄り）`;
    if(value < -3) return `${label}：${value.toFixed(1)}（かなり逆側寄り）`;
    if(value < -1) return `${label}：${value.toFixed(1)}（やや逆側寄り）`;
    return `${label}：${value.toFixed(1)}（中間）`;
  }
  html.push(`<h3>📊 軸スコア</h3>`);
  html.push(`<p>
    ${explainAxis("E/I", ax.EI)}<br>
    ${explainAxis("N/S", ax.NS)}<br>
    ${explainAxis("T/F", ax.TF)}<br>
    ${explainAxis("J/P", ax.JP)}
  </p>`);

  // 結果をカードに反映
  const card = document.getElementById('resultCard');
  card.innerHTML = html.join('');
  card.style.display='block';

  // コピー用テキスト
  const variantText = variantKey && d.variants ? `／補足：${d.variants[variantKey]}` : "";
  card.dataset.share = `【雲井鳴診断】タイプ：${t.name}${variantText}（ソシオニクス=${lastResult.tKey}, クアドラ=${t.quadra})`;
}

/* ===================== モード切替 ===================== */
let current = [];
let answers = {};
let lastResult = null;

function setMode(mode){
  if(mode === '24') {
    current = Q24;
    document.getElementById("modeLabel").textContent = "24問版（改良）";
  } else if(mode === '60') {
    current = Q60;
    document.getElementById("modeLabel").textContent = "60問版（じっくり）";
  }
  answers = {};

  // 質問を描画
  const qc = document.getElementById("questionCard");
  qc.innerHTML = current.map((q,i)=>`
    <div class="q" id="${q.id}">
      <div class="qtitle">Q${i+1}. ${q.text}</div>
      <div class="slider">
        <span>-5</span>
        <input type="range" min="-5" max="5" step="1" value="0"
          oninput="answers['${q.id}']=Number(this.value);updateProgress()">
        <span>+5</span>
      </div>
    </div>
  `).join('');

  updateProgress();
}
/* ===================== 軸スコア計算 ===================== */
function computeAxes(){
  const ax = {EI:0, NS:0, TF:0, JP:0};
  let counts = {EI:0, NS:0, TF:0, JP:0};

  current.forEach(q=>{
    const val = answers[q.id];
    if(val !== undefined){
      if(ax.hasOwnProperty(q.axis)){
        ax[q.axis] += val * q.polarity;
        counts[q.axis]++;
      }
    }
  });

  // 平均値にする
  for(const k in ax){
    if(counts[k] > 0){
      ax[k] = ax[k] / counts[k];
    }
  }
  return ax;
}

/* ===================== タイプ判定 ===================== */
function pickType(ax){
  const ei = ax.EI >= 0 ? 'E' : 'I';
  const ns = ax.NS >= 0 ? 'N' : 'S';
  const tf = ax.TF >= 0 ? 'T' : 'F';
  const jp = ax.JP >= 0 ? 'J' : 'P';

  const mbtiKey = ei + ns + tf + jp;

  // MBTI → ソシオニクス対応表
  const map = {
    ENFP:'IEE', INFp:'IEI',
    ENFJ:'EIE', INFj:'EII',
    ENTP:'ILE', INTj:'LII',
    ENTj:'LIE', INTp:'ILI',
    ESFj:'ESE', ISFj:'ESI',
    ESFp:'SEE', ESTp:'SLE',
    ISFp:'SEI', ESTj:'LSE',
    ISTj:'LSI', ISTp:'SLI',
  };

  const tKey = map[mbtiKey] || 'IEE';
  return tKey;
}

/* ===================== 進捗更新 ===================== */
function updateProgress(){
  const answered = Object.keys(answers).length;
  const progress = Math.round((answered / current.length) * 100);
  document.getElementById("bar").style.width = progress + "%";
  document.getElementById("count").textContent = `${answered}/${current.length} 回答（${progress}%）`;
}

/* ===================== 結果計算 ===================== */
function buildResult(){
  const ax = computeAxes();
  const key = pickType(ax);
  const t = TYPES[key];
  const rel = REL[key];
  const d = DETAIL[key];
  lastResult = { t, rel, d, ax, tKey: key };
  renderResultView();
}
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(()=>{
    alert("結果をコピーしました！");
  }).catch(()=>{
    alert("コピーに失敗しました");
  });
}


/* ===================== UI制御 ===================== */
function tryShowResult(){
  const unanswered = current.filter(q => answers[q.id]===undefined || answers[q.id]===null);
  if(unanswered.length>0){
    const first = unanswered[0];
    const inputEl = document.getElementById(first.id);
    if(inputEl){
      const card = inputEl.closest('.q');
      if(card){
        card.scrollIntoView({behavior:'smooth', block:'center'});
        card.classList.add('highlight');
        setTimeout(()=>card.classList.remove('highlight'),4000);
      }
    }
    document.getElementById('warnMsg').textContent = `⚠ 未回答があります（残り ${unanswered.length} 問）`;
    return;
  }
  buildResult();
}

function init(){
  document.getElementById('mode24').addEventListener('click',()=>setMode('24'));
  document.getElementById('mode60').addEventListener('click',()=>setMode('60'));
  document.getElementById('calcBtn').addEventListener('click', tryShowResult);
  document.getElementById('copyBtn').addEventListener('click', ()=>{
    const txt = document.getElementById('resultCard').dataset.share || '';
    if(!txt){
      alert('まず結果を表示してください。');
      return;
    }
    copyToClipboard(txt);
  });
  setMode('24'); // デフォルトは24問版（改良）
}
document.addEventListener('DOMContentLoaded', init);
</script>
</body>

</html>
